<p id="notice"><%= notice %></p>

<h1><%= _("Products") %></h1>


<div class="ml-3">
  <%= link_to _('+ New Product'), new_product_path, :class => 'btn btn-secondary mr-1 mb-3' %>
  <%= link_to _('<i class="fa-solid fa-download"></i> Export as Excel').html_safe , products_path(format: :xlsx), class: "btn btn-primary mr-1 mb-3" %>
  <%= link_to _('<i class="fa-solid fa-file-import"></i> Import from Excel').html_safe , new_products_import_path, class: "btn btn-primary mr-1 mb-3" %>
</div>

<div class="">
  <%= form_tag products_path, :method => 'get' do %>
    <div class="input-group input-group-sm mb-3  col-10 col-xl-5 col-lg-6 col-md-7 col-sm-10">
      <%= text_field_tag :search, params[:search], class: 'form-control' %>
        <div class="input-group-append">
          <%= button_tag(type: "submit", class: "btn btn-warning") do %>
          <%= _("Search") %> <i class="fa-solid fa-magnifying-glass"></i>
          <% end %>
        </div>
    </div> 
  <% end %>
</div>

<h2> Finished Products </h2>
<table class="mb-5">
  <thead>
    <tr>
    <th class="align_left col-1"><%= sortable "id", _("Id") %></th>
      <th class="align_left col-2"><%= sortable "product_name", _("Product Name") %></th>
      <th class="align_right col-2"><%= sortable "price", _("Sale price") %></th>
      <th class="align_right col-2"><%= sortable "grams_per_unit", _("Grams per unit") %></th>      
      <th class="col-2"><%= sortable "unit", _("Unit") %></th>
      
      
    </tr>
  </thead>

  <tbody>
    <% @finished_products.each do |pi| %>
      <tr>
        <td class="col-1"><%= pi["id"] %></td>
        <td class="col-2"><%= pi["product_name"] %></td>
        <td class="align_right col-2"><%= pi["price"] %></td>
        <td class="align_right col-2"><%= number_with_precision(pi["grams_per_unit"], :precision => 1, delimiter: ' ') %>g</td>
        <td class="col-2"><%= pi["unit"] %></td>
           
        <td class="col-1">
          <%= link_to '<i class="fa-solid fa-pencil"></i>'.html_safe,  edit_product_path(pi), class: "text-secondary m-2" %>
          <%= link_to '<i class="fa-solid fa-trash-can"></i>'.html_safe, pi, method: :delete, data: { confirm: 'Are you sure?' }, class: "text-danger m-2" %>
        </td>        
      </tr>
    <% end %>        
  </tbody>
</table>

<h2> Semi-Finished Products </h2>

<table class="mb-5">
  <thead>
    <tr>
    <th class="align_left col-1"><%= sortable "id", _("Id") %></th>
      <th class="align_left col-2"><%= sortable "product_name", _("Product Name") %></th>
      <th class="align_right col-2"><%= sortable "price", _("Sale price") %></th>
      <th class="align_right col-2"><%= sortable "grams_per_unit", _("Grams per unit") %></th>      
      <th class="col-2"><%= sortable "unit", _("Unit") %></th>
      
    </tr>
  </thead>
  <tbody>
    <% @semi_finished_products.each do |pi| %>
      <tr>
        <td class="col-1"><%= pi["id"] %></td>
        <td class="col-2"><%= pi["product_name"] %></td>
        <td class="align_right col-2"><%= pi["price"] %></td>
        <td class="align_right col-2"><%= number_with_precision(pi["grams_per_unit"], :precision => 1, delimiter: ' ') %>g</td>
        <td class="col-2"><%= pi["unit"] %></td>
           
        <td class="col-1">
          <%= link_to '<i class="fa-solid fa-pencil"></i>'.html_safe,  edit_product_path(pi), class: "text-secondary m-2" %>
          <%= link_to '<i class="fa-solid fa-trash-can"></i>'.html_safe, pi, method: :delete, data: { confirm: 'Are you sure?' }, class: "text-danger m-2" %>
        </td>        
      </tr>
    <% end %>        
  </tbody>
</table>

<h2> Raw Ingredients </h2>

<table class="mb-5">
  <thead>
    <tr>
    <th class="align_left col-1"><%= sortable "id", _("Id") %></th>
      <th class="align_left col-2"><%= sortable "product_name", _("Product Name") %></th>
      <th class="align_right col-2"><%= sortable "price", _("Sale price") %></th>
      <th class="align_right col-2"><%= sortable "grams_per_unit", _("Grams per unit") %></th>      
      <th class="col-2"><%= sortable "unit", _("Unit") %></th>
      
    </tr>
  </thead>
  <tbody>
    <% @raw_ingredients.each do |pi| %>
      <tr>
        <td class="col-1"><%= pi["id"] %></td>
        <td class="col-2"><%= pi["product_name"] %></td>
        <td class="align_right col-2"><%= pi["price"] %></td>
        <td class="align_right col-2"><%= number_with_precision(pi["grams_per_unit"], :precision => 1, delimiter: ' ') %>g</td>
        <td class="col-2"><%= pi["unit"] %></td>
           
        <td class="col-1">
          <%= link_to '<i class="fa-solid fa-pencil"></i>'.html_safe,  edit_product_path(pi), class: "text-secondary m-2" %>
          <%= link_to '<i class="fa-solid fa-trash-can"></i>'.html_safe, pi, method: :delete, data: { confirm: 'Are you sure?' }, class: "text-danger m-2" %>
        </td>        
      </tr>
    <% end %>        
  </tbody>
</table>

<h2> Other Products </h2>

<table class="mb-5">
  <thead>
    <tr>
    <th class="align_left col-1"><%= sortable "id", _("Id") %></th>
      <th class="align_left col-2"><%= sortable "product_name", _("Product Name") %></th>
      <th class="align_right col-2"><%= sortable "price", _("Sale price") %></th>
      <th class="align_right col-2"><%= sortable "grams_per_unit", _("Grams per unit") %></th>      
      <th class="col-2"><%= sortable "unit", _("Unit") %></th>
      
    </tr>
  </thead>
  <tbody>
    <% @other_products.each do |pi| %>
      <tr>
        <td class="col-1"><%= pi["id"] %></td>
        <td class="col-2"><%= pi["product_name"] %></td>
        <td class="align_right col-2"><%= pi["price"] %></td>
        <td class="align_right col-2"><%= number_with_precision(pi["grams_per_unit"], :precision => 1, delimiter: ' ') %>g</td>
        <td class="col-2"><%= pi["unit"] %></td>
           
        <td class="col-1">
          <%= link_to '<i class="fa-solid fa-pencil"></i>'.html_safe,  edit_product_path(pi), class: "text-secondary m-2" %>
          <%= link_to '<i class="fa-solid fa-trash-can"></i>'.html_safe, pi, method: :delete, data: { confirm: 'Are you sure?' }, class: "text-danger m-2" %>
        </td>        
      </tr>
    <% end %>        
  </tbody>
</table>





