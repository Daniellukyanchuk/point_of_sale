<p id="notice"><%= notice %></p>

<h1>Product Sales Report</h1>

<%= form_tag reports_product_report_path, :method => 'get' do %>
  
  <%= text_field_tag :search, params[:search] %> 
  or
  <% options = Product.all.collect{ |p| [p.product_name, p.id] } %>
  <% options = [["Show All", nil]] + options %>
  <%= select_tag 'product_select[]', options_for_select(options, params[:product_select]), :multiple => :multiple, :size => 10, :class => "chosen-select" %>

  <%= submit_tag "Search", :product_name => nil %>
<% end %>

<table>
  <thead>
    <tr>
    <th class="align_left"><%= sortable "product_id", "Id" %></th>
    <th class="align_left"><%= sortable "product_name", "Product Name" %></th>
    <th class="align_right"><%= sortable "units_sold", "Units Sold" %></th>
    <th class="align_left"><%= sortable "unit", "Unit" %></th>
    <th><%= sortable "total_revenue", "Total Revenue" %></th>
    <th colspan="4"></th>
    </tr>
  </thead>

  <tbody>
    <% @product_reports.each do |p_report| %> 
      <tr>     
        <td><%= p_report["product_id"] %></td>
        <td><%= p_report["product_name"] %></td>
        <td class="align_right"><%= p_report["units_sold"] %></td>
        <td><%= p_report["unit"] %></td>
        <td class="align_right"><%= p_report["total_revenue"] %></td>
      </tr>
      <% end %>
  </tbody>
</table>

<script type="text/javascript">

$(".chosen-select").chosen({
  no_results_text: "Oops, nothing found!"
})

</script>